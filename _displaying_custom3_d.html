<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Carna: Displaying Custom 3D Geometry</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<link href="doc_00style.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Carna&#160;<span id="projectnumber">Version 2.5.0</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Displaying Custom 3D Geometry </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>Carna defines an interface that objects must implement that do represent 3D geometry. This interface is provided by the abstract <a class="el" href="class_carna_1_1base_1_1model_1_1_object3_d.html">model::Object3D</a> class.</p>
<h2><a class="anchor" id="Object3D_Rendering"></a>
Rendering 3D objects</h2>
<p>The moment an <code>Object3D</code> implementation is instantiated it is automatically added to the <a class="el" href="class_carna_1_1base_1_1model_1_1_scene.html">scene</a> that is provided to it's constructor. It's destructor takes care of removing the object from the scene analogously. However, this does not mean necessarily that every instantiated 3D object is always rendered. There are several ways of turning objects invisible. But lets first take a look at how the 3D geometry, such a <code>Object3D</code> implementation specifies, is rendered.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>If the scene is destroyed while there are still objects associated with it, these objects are also destroyed automatically.</dd></dl>
<p>Remember that a renderer's task is to visualize a given scene. This task includes rendering the 3D volume data in particular, but also rendering all the 3D geometry. The renderers, that are provided out-of-the-box, are designed to perform the rendering of the 3D volume data in a certain way. For the sake of decoupling, the latter sub-task, the rendering of the additional 3D geometry, is delegated to other objects. Note that this is not something, a custom renderer implementation would have to do necessarily.</p>
<p>The out-of-the-box mechanisms do delegate the task of rendering the additional 3D geometry not only once. Actually, it is handed over to a whole sequence of stages. These stages are described below. You can modify each of these stages to achieve the results you require.</p>
<dl class="user"><dt><b>Stage 1: the renderer's level</b></dt><dd></dd></dl>
<p>What renderers typically do in the first place is invoking their <a class="el" href="class_carna_1_1base_1_1view_1_1_renderer.html#aea8bc001bd056de2bf00d21e3463eba5">paintObjects3D</a> method at some point of their <a class="el" href="class_carna_1_1base_1_1view_1_1_renderer.html#a4b993e680fb5a2507375a648eb1b760b">rendering routine</a>.</p>
<p>If you needed to modify the 3D objects rendering behaviour at a renderer's level, you could derive a custom renderer from an out-of-the-box renderer and override it's <code>paintObjects3D</code> method to do whatever you desire.</p>
<dl class="user"><dt><b>Stage 2: the objects entirety level</b></dt><dd></dd></dl>
<p>Each <code>Renderer</code> instance is associated with an <a class="el" href="class_carna_1_1base_1_1view_1_1_object3_d_painter.html">Object3DPainter</a> object. This describes the <em>entirety</em> of additional 3D geometry that is to be rendered. The default implementation of a renderer's <code>paintObjects3D</code> method invokes it's <a class="el" href="class_carna_1_1base_1_1view_1_1_object3_d_painter.html#a44d19cd2422a1d926c69c7ccf7ce06b1">paint</a> method.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>The set of existing <code>Object3D</code> instances can be retrieved via <a class="el" href="class_carna_1_1base_1_1model_1_1_scene.html#ad60727cc0679126692e87cd3b909b0e7">Scene::objectsCount</a> and <a class="el" href="class_carna_1_1base_1_1model_1_1_scene.html#a03fb51ea6468d8771f10a49d3f0951f7">Scene::objectByIndex</a> from the scene.</dd></dl>
<p>If you needed to modify the 3D objects rendering behaviour for more than one renderer in the same way, or if you do not want to use a custom renderer for any reason, it is a good idea to implement your own <code>Object3DPainter</code> and <a class="el" href="class_carna_1_1base_1_1view_1_1_renderer.html#a215f87b55e134ea01d60ea038bace926">set it on the renderer</a>.</p>
<dl class="attention"><dt><b>Attention:</b></dt><dd>This is the recommended way of modifying the objects rendering behaviour.</dd></dl>
<p>There is a small set of predefined classes that are meant to be used in combination with <code>DefaultObject3DPainter</code> to easily exclude certain objects from being rendered:</p>
<ol type="1">
<li>Use a <a class="el" href="namespace_carna_1_1base_1_1model.html#a164815937370810b950d042c6fe47b39">model::Object3DWhitelist</a> to render only explicitly specified objects.</li>
<li>Use a <a class="el" href="namespace_carna_1_1base_1_1model.html#a103083f06d05c5af5dec5bd73c9732c7">model::Object3DBlacklist</a> to render all objects except those that are blacklisted.</li>
</ol>
<p>They are used like this:</p>
<div class="fragment"><pre class="fragment"> <a class="code" href="class_carna_1_1base_1_1view_1_1_renderer.html" title="Represents the view component of a visualization and implements its rendering logic.">Carna::base::view::Renderer</a>&amp; renderer;       <span class="comment">//&lt; some renderer</span>
 <span class="keyword">const</span> <a class="code" href="class_carna_1_1base_1_1model_1_1_object3_d.html" title="Represents an object in 3D space.">Carna::base::model::Object3D</a>&amp; object;  <span class="comment">//&lt; only object to be painted</span>

 <span class="keyword">auto</span> <span class="keyword">const</span> whitelist = <span class="keyword">new</span> <a class="code" href="namespace_carna_1_1base_1_1model.html#a164815937370810b950d042c6fe47b39" title="Defines a white-list of Object3D instances.">Carna::base::model::Object3DWhitelist</a>();
 whitelist-&gt;put( <span class="keywordtype">object</span> );

 <span class="keyword">auto</span> <span class="keyword">const</span> painter = <span class="keyword">new</span> <a class="code" href="class_carna_1_1base_1_1view_1_1_default_object3_d_painter.html" title="Paints all Object3D instances associated with a data model.">Carna::base::view::DefaultObject3DPainter</a>( renderer.<a class="code" href="class_carna_1_1base_1_1view_1_1_renderer.html#aba46767cf60b841360dd669aef94f93c" title="References the aggregated data model interface.">provider</a>.scene, whitelist );
 renderer.setObjectPainter( painter );
</pre></div><p>If you wanted to disable the rendering of additional geometry on this level, you could simply set a null implementation of <code>Object3DPainter</code> on the renderer: In terms of software design patterns, this is an implementation whose <code>paint</code> method does nothing.</p>
<dl class="user"><dt><b>Stage 3: the painting routine level</b></dt><dd></dd></dl>
<p>When a renderer invokes the <code>paint</code> method of a <code>Object3DPainter</code> object, it also provides it a <a class="el" href="class_carna_1_1base_1_1view_1_1_object3_d_painting_routine.html">Object3DPaintingRoutine</a> object. This one defines the routine that is to be used for rendering a <em>single</em> 3D object. The <a class="el" href="class_carna_1_1base_1_1view_1_1_default_object3_d_painter.html">default <code>Object3DPainter</code> implementation</a> simply invokes this routine on each object that exists within the scene.</p>
<p>The renderer's default <code>paintObjects3D</code> uses an instance of the <a class="el" href="class_carna_1_1base_1_1view_1_1_default_object3_d_painting_routine.html">DefaultObject3DPaintingRoutine</a> class here. It calls the <a class="el" href="class_carna_1_1base_1_1model_1_1_object3_d.html#af4b0003d5db4acd4775a1c1af7353bbb">paint</a> method of the <code>Object3D</code> that it is given.</p>
<p>Note that the <code>Renderer</code> class also defines an overloaded <code>paintObjects3D</code> method that takes any custom <code>Object3DPaintingRoutine</code> to use in place of <code>DefaultObject3DPaintingRoutine</code>. This mechanism is utilized by <a class="el" href="class_carna_1_1base_1_1view_1_1_renderer.html#ae6aed59e78bbda816a1c472588481ff9">renderers to implement picking</a> by <a class="el" href="class_carna_1_1base_1_1view_1_1_incremental_color_painting_routine.html">painting each object in an unique color code</a>.</p>
<dl class="user"><dt><b>Stage 4: the object's level</b></dt><dd></dd></dl>
<p>This is the way the <code>paint</code> method of an <code>Object3D</code> implementation is usually called. Here the object defines it's own geometry by implementing a code that is necessary to render it.</p>
<dl class="see"><dt><b>See also:</b></dt><dd>Read more on how to create custom <code>Object3D</code> implementations <a class="el" href="class_carna_1_1base_1_1model_1_1_object3_d.html#Object3D_Deriving">here</a>.</dd></dl>
<h2><a class="anchor" id="Object3D_out_of_the_box"></a>
Existing Implementations</h2>
<p>Out-of-the-box provided <code>Object3D</code> implementations are:</p>
<ul>
<li><a class="el" href="class_carna_1_1base_1_1view_1_1_point3_d.html">Carna::base::view::Point3D</a> for displaying dots</li>
<li><a class="el" href="class_carna_1_1base_1_1view_1_1_polyline3_d_vertex.html">Carna::base::view::Polyline3DVertex</a> for displaying polylines </li>
</ul>
</div></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/>
    <address class="footer">
        <small>
			Written by <a href="http://evoid.de">Leonid Kostrykin</a> at the
            Chair of Medical Engineering (mediTEC),
            RWTH Aachen University <p>
            Documentation generated by <a href="http://www.doxygen.org/index.html"> Doxygen </a>
        </small>
    </address>

</body>
</html>
